<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.68.3"><link rel="shortcut icon" href=https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr@1.2.0/favicons/favicon.ico><title>Mongoid エラーメッセージが翻訳されない時 - mknkisk.log</title><meta name=author content><meta name=description content="Env  Rails 4.2.7 Mongoid 5.1.1  Mongoid のエラーメッセージを正常に出力する 英語以外のロケールで Mongoid を使用していると、 Mongoid のエラーが発生した際にそのエラーメッセージが翻訳できずに translation missing エラーが発生してしまいます。
Mongoid::Errors::DocumentNotFound: translation missing: ja.mongoid.errors.messages.message_title: translation missing: ja.mongoid.errors.messages.document_not_found.message translation missing: ja.mongoid.errors.messages.summary_title: translation missing: ja.mongoid.errors.messages.document_not_found.summary translation missing: ja.mongoid.errors.messages.resolution_title: translation missing: ja.mongoid.errors.messages.document_not_found.resolution from /Users/himeko/work/MyApp/vendor/bundle/ruby/2.3.0/gems/mongoid-5.1.1/lib/mongoid/criteria.rb:454:in `check_for_missing_documents!' エラーメッセージは英語で構わないですし、翻訳できない場合は英語にするように設定してしまいます。
application.rb
config.i18n.default_locale = :ja + config.i18n.fallbacks = { ja: :en } すると正しくエラーメッセージが表示されるようになります。
Mongoid::Errors::DocumentNotFound: message: Document(s) not found for class User with id(s) {:id=>&#34;1&#34;}. summary: When calling User.find with an id or array of ids, each parameter must match a document in the database or this error will be raised."><meta property="og:title" content="Mongoid エラーメッセージが翻訳されない時"><meta property="og:description" content="Env  Rails 4.2.7 Mongoid 5.1.1  Mongoid のエラーメッセージを正常に出力する 英語以外のロケールで Mongoid を使用していると、 Mongoid のエラーが発生した際にそのエラーメッセージが翻訳できずに translation missing エラーが発生してしまいます。
Mongoid::Errors::DocumentNotFound: translation missing: ja.mongoid.errors.messages.message_title: translation missing: ja.mongoid.errors.messages.document_not_found.message translation missing: ja.mongoid.errors.messages.summary_title: translation missing: ja.mongoid.errors.messages.document_not_found.summary translation missing: ja.mongoid.errors.messages.resolution_title: translation missing: ja.mongoid.errors.messages.document_not_found.resolution from /Users/himeko/work/MyApp/vendor/bundle/ruby/2.3.0/gems/mongoid-5.1.1/lib/mongoid/criteria.rb:454:in `check_for_missing_documents!' エラーメッセージは英語で構わないですし、翻訳できない場合は英語にするように設定してしまいます。
application.rb
config.i18n.default_locale = :ja + config.i18n.fallbacks = { ja: :en } すると正しくエラーメッセージが表示されるようになります。
Mongoid::Errors::DocumentNotFound: message: Document(s) not found for class User with id(s) {:id=>&#34;1&#34;}. summary: When calling User.find with an id or array of ids, each parameter must match a document in the database or this error will be raised."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.mknkisk.com/posts/mongoid-translation-missing/"><meta property="article:published_time" content="2016-07-24T17:16:05+09:00"><meta property="article:modified_time" content="2016-07-24T17:16:05+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Mongoid エラーメッセージが翻訳されない時"><meta name=twitter:description content="Env  Rails 4.2.7 Mongoid 5.1.1  Mongoid のエラーメッセージを正常に出力する 英語以外のロケールで Mongoid を使用していると、 Mongoid のエラーが発生した際にそのエラーメッセージが翻訳できずに translation missing エラーが発生してしまいます。
Mongoid::Errors::DocumentNotFound: translation missing: ja.mongoid.errors.messages.message_title: translation missing: ja.mongoid.errors.messages.document_not_found.message translation missing: ja.mongoid.errors.messages.summary_title: translation missing: ja.mongoid.errors.messages.document_not_found.summary translation missing: ja.mongoid.errors.messages.resolution_title: translation missing: ja.mongoid.errors.messages.document_not_found.resolution from /Users/himeko/work/MyApp/vendor/bundle/ruby/2.3.0/gems/mongoid-5.1.1/lib/mongoid/criteria.rb:454:in `check_for_missing_documents!' エラーメッセージは英語で構わないですし、翻訳できない場合は英語にするように設定してしまいます。
application.rb
config.i18n.default_locale = :ja + config.i18n.fallbacks = { ja: :en } すると正しくエラーメッセージが表示されるようになります。
Mongoid::Errors::DocumentNotFound: message: Document(s) not found for class User with id(s) {:id=>&#34;1&#34;}. summary: When calling User.find with an id or array of ids, each parameter must match a document in the database or this error will be raised."><link rel=stylesheet href=https://blog.mknkisk.com/css/main.min.css><script src=https://blog.mknkisk.com/js/jquery.min.js></script><script src=https://blog.mknkisk.com/js/lazysizes.min.js></script><link rel=stylesheet href=https://blog.mknkisk.com/css/fontawsome.min.css><script src=https://blog.mknkisk.com/js/medium-zoom.min.js></script><body class="d-flex flex-column h-100"><header><div class="container-lg clearfix"><div class="col-12 link-primary"><a class=main-title href=https://blog.mknkisk.com/>mknkisk.log</a></div></div></header><main><div class="container-lg clearfix"><div class="col-md-9 col-12 float-left" id=content><article><h4 class=post-title><a href=https://blog.mknkisk.com/posts/mongoid-translation-missing/>Mongoid エラーメッセージが翻訳されない時</a></h4><div class="post-meta link-alter"><time><i class="fas fa-calendar-day"></i>&nbsp;2016-07-24</time><span><i class="fas fa-tag"></i>&nbsp;No tag</span></div><div class="post-content markdown-body"><h2 id=env>Env</h2><ul><li>Rails 4.2.7</li><li>Mongoid 5.1.1</li></ul><h2 id=mongoid-のエラーメッセージを正常に出力する>Mongoid のエラーメッセージを正常に出力する</h2><p>英語以外のロケールで Mongoid を使用していると、 Mongoid のエラーが発生した際にそのエラーメッセージが翻訳できずに <code>translation missing</code> エラーが発生してしまいます。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rb data-lang=rb><span style=color:#66d9ef>Mongoid</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Errors</span><span style=color:#f92672>::</span><span style=color:#e6db74>DocumentNotFound</span>:
translation <span style=color:#e6db74>missing</span>: ja<span style=color:#f92672>.</span>mongoid<span style=color:#f92672>.</span>errors<span style=color:#f92672>.</span>messages<span style=color:#f92672>.</span>message_title:
  translation <span style=color:#e6db74>missing</span>: ja<span style=color:#f92672>.</span>mongoid<span style=color:#f92672>.</span>errors<span style=color:#f92672>.</span>messages<span style=color:#f92672>.</span>document_not_found<span style=color:#f92672>.</span>message
translation <span style=color:#e6db74>missing</span>: ja<span style=color:#f92672>.</span>mongoid<span style=color:#f92672>.</span>errors<span style=color:#f92672>.</span>messages<span style=color:#f92672>.</span>summary_title:
  translation <span style=color:#e6db74>missing</span>: ja<span style=color:#f92672>.</span>mongoid<span style=color:#f92672>.</span>errors<span style=color:#f92672>.</span>messages<span style=color:#f92672>.</span>document_not_found<span style=color:#f92672>.</span>summary
translation <span style=color:#e6db74>missing</span>: ja<span style=color:#f92672>.</span>mongoid<span style=color:#f92672>.</span>errors<span style=color:#f92672>.</span>messages<span style=color:#f92672>.</span>resolution_title:
  translation <span style=color:#e6db74>missing</span>: ja<span style=color:#f92672>.</span>mongoid<span style=color:#f92672>.</span>errors<span style=color:#f92672>.</span>messages<span style=color:#f92672>.</span>document_not_found<span style=color:#f92672>.</span>resolution
from <span style=color:#e6db74>/Users/</span>himeko<span style=color:#f92672>/</span>work<span style=color:#f92672>/</span><span style=color:#66d9ef>MyApp</span><span style=color:#f92672>/</span>vendor<span style=color:#f92672>/</span>bundle<span style=color:#f92672>/</span>ruby<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#f92672>.</span><span style=color:#ae81ff>3</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>/</span>gems<span style=color:#f92672>/</span>mongoid<span style=color:#f92672>-</span><span style=color:#ae81ff>5</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>mongoid<span style=color:#f92672>/</span>criteria<span style=color:#f92672>.</span>rb:<span style=color:#ae81ff>454</span><span style=color:#e6db74>:in</span> <span style=color:#e6db74>`check_for_missing_documents!&#39;
</span></code></pre></div><p>エラーメッセージは英語で構わないですし、翻訳できない場合は英語にするように設定してしまいます。</p><p>application.rb</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff>config.i18n.default_locale = :ja
<span style=color:#a6e22e>+ config.i18n.fallbacks = { ja: :en }
</span></code></pre></div><p>すると正しくエラーメッセージが表示されるようになります。</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rb data-lang=rb><span style=color:#66d9ef>Mongoid</span><span style=color:#f92672>::</span><span style=color:#66d9ef>Errors</span><span style=color:#f92672>::</span><span style=color:#e6db74>DocumentNotFound</span>:
<span style=color:#e6db74>message</span>:
  <span style=color:#66d9ef>Document</span>(s) <span style=color:#f92672>not</span> found <span style=color:#66d9ef>for</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> with id(s) {<span style=color:#e6db74>:id</span><span style=color:#f92672>=&gt;</span><span style=color:#e6db74>&#34;1&#34;</span>}<span style=color:#f92672>.</span>
<span style=color:#e6db74>summary</span>:
  <span style=color:#66d9ef>When</span> calling <span style=color:#66d9ef>User</span><span style=color:#f92672>.</span>find with an id <span style=color:#f92672>or</span> array of ids, each parameter must match a document <span style=color:#66d9ef>in</span> the database <span style=color:#f92672>or</span> this error will be raised<span style=color:#f92672>.</span> <span style=color:#66d9ef>The</span> search was <span style=color:#66d9ef>for</span> the id(s): {<span style=color:#e6db74>:id</span><span style=color:#f92672>=&gt;</span><span style=color:#e6db74>&#34;1&#34;</span>} <span style=color:#f92672>...</span> (<span style=color:#ae81ff>1</span> total) <span style=color:#f92672>and</span> the following ids were <span style=color:#f92672>not</span> <span style=color:#e6db74>found</span>: {<span style=color:#e6db74>:id</span><span style=color:#f92672>=&gt;</span><span style=color:#e6db74>&#34;1&#34;</span>}<span style=color:#f92672>.</span>
<span style=color:#e6db74>resolution</span>:
  <span style=color:#66d9ef>Search</span> <span style=color:#66d9ef>for</span> an id that is <span style=color:#66d9ef>in</span> the database <span style=color:#f92672>or</span> set the <span style=color:#66d9ef>Mongoid</span><span style=color:#f92672>.</span>raise_not_found_error configuration option to <span style=color:#66d9ef>false</span>, which will cause a <span style=color:#66d9ef>nil</span> to be returned instead of raising this error <span style=color:#66d9ef>when</span> searching <span style=color:#66d9ef>for</span> a single id, <span style=color:#f92672>or</span> only the matched documents <span style=color:#66d9ef>when</span> searching <span style=color:#66d9ef>for</span> multiples<span style=color:#f92672>.</span>
from <span style=color:#e6db74>/rails_root/</span>vendor<span style=color:#f92672>/</span>bundle<span style=color:#f92672>/</span>ruby<span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#f92672>.</span><span style=color:#ae81ff>3</span><span style=color:#f92672>.</span><span style=color:#ae81ff>0</span><span style=color:#f92672>/</span>gems<span style=color:#f92672>/</span>mongoid<span style=color:#f92672>-</span><span style=color:#ae81ff>5</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1</span><span style=color:#f92672>.</span><span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>lib<span style=color:#f92672>/</span>mongoid<span style=color:#f92672>/</span>criteria<span style=color:#f92672>.</span>rb:<span style=color:#ae81ff>454</span><span style=color:#e6db74>:in</span> <span style=color:#e6db74>`check_for_missing_documents!&#39;
</span></code></pre></div></div></article><div class="license markdown-body"><blockquote><p>Unless otherwise noted, the content of this site is licensed under <a rel=license href target=_blank></a>.</p></blockquote></div></div><div class="col-md-3 col-12 float-left link-alter" id=sidebar><div class=widget-toc><h5>TOC</h5><nav id=TableOfContents><ul><li><a href=#env>Env</a></li><li><a href=#mongoid-のエラーメッセージを正常に出力する>Mongoid のエラーメッセージを正常に出力する</a></li></ul></nav></div><div class=widget-pages><h5>Pages</h5><ul><li><a href=/index.xml target=_blank>RSS</a></li></ul></div><div class=widget-tags><h5>Tags</h5><div></div></div><div class=widget-links><h5>Links</h5><ul></ul></div></div></div></main><footer><div class="container-lg text-center"><p>&copy; 2020 <a href=https://blog.mknkisk.com/></a>| Powered by <a href=https://github.com/amzrk2/hugo-theme-fuji/ target=_blank>Fuji</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></p></div></footer><script>$(function(){mediumZoom('.img-zoomable',{margin:32});});</script><script>$('.widget-toc a').click(function(){$('html, body').animate({scrollTop:$($(this).attr('href')).offset().top});});</script></body></html>