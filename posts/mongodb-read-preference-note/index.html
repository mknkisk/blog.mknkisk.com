<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.68.3"><link rel="shortcut icon" href=https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr@1.2.0/favicons/favicon.ico><title>MongoDB : Replica Set の参照設定 - mknkisk.log</title><meta name=author content><meta name=description content="📝MongoDB のドキュメントを箇条書きしていく。随時更新
Env / Versions  MongoDB v3.6  参照の優先度設定  ⚠️ Primary から Secondary への非同期レプリケーションには遅延が発生するため、古いデータが返される可能性がある  参照のモード  各 MongoDB ドライバーは以下の５つのモードをサポートしている  primary  Primary からのみ参照する Primary が使用できない場合はエラーになる デフォルト  primaryPreferred  Primary から参照するが使用できない場合は Secondary から参照する  secondary  Secondary からのみ参照する 使用可能な Secondary が無い場合はエラーになる  secondaryPreferred  Secondary から参照するが使用可能な Secondary が１台もない場合は Primary から参照する  nearest  ネットワークレイテンシが最も低いメンバーから参照する Primary, Secondary 問わない  サーバ選択アルゴリズム  サーバーの選択は操作ごとに1回発生し、参照設定とlocalThresholdMS の設定によって決められる サーバ選択アルゴリズムは各クライアントで実装されている secondary または secondaryPreferred モードを指定した場合 * 最も低いレイテンシ + 15msec 以内のサーバを「使用可能」とする  15msec はデフォルト値であり変更可能 「使用可能」なサーバ群からランダムで接続先が決定される    Links  https://docs."><meta property="og:title" content="MongoDB : Replica Set の参照設定"><meta property="og:description" content="📝MongoDB のドキュメントを箇条書きしていく。随時更新
Env / Versions  MongoDB v3.6  参照の優先度設定  ⚠️ Primary から Secondary への非同期レプリケーションには遅延が発生するため、古いデータが返される可能性がある  参照のモード  各 MongoDB ドライバーは以下の５つのモードをサポートしている  primary  Primary からのみ参照する Primary が使用できない場合はエラーになる デフォルト  primaryPreferred  Primary から参照するが使用できない場合は Secondary から参照する  secondary  Secondary からのみ参照する 使用可能な Secondary が無い場合はエラーになる  secondaryPreferred  Secondary から参照するが使用可能な Secondary が１台もない場合は Primary から参照する  nearest  ネットワークレイテンシが最も低いメンバーから参照する Primary, Secondary 問わない  サーバ選択アルゴリズム  サーバーの選択は操作ごとに1回発生し、参照設定とlocalThresholdMS の設定によって決められる サーバ選択アルゴリズムは各クライアントで実装されている secondary または secondaryPreferred モードを指定した場合 * 最も低いレイテンシ + 15msec 以内のサーバを「使用可能」とする  15msec はデフォルト値であり変更可能 「使用可能」なサーバ群からランダムで接続先が決定される    Links  https://docs."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.mknkisk.com/posts/mongodb-read-preference-note/"><meta property="article:published_time" content="2018-06-04T01:36:29+09:00"><meta property="article:modified_time" content="2018-06-04T01:36:29+09:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="MongoDB : Replica Set の参照設定"><meta name=twitter:description content="📝MongoDB のドキュメントを箇条書きしていく。随時更新
Env / Versions  MongoDB v3.6  参照の優先度設定  ⚠️ Primary から Secondary への非同期レプリケーションには遅延が発生するため、古いデータが返される可能性がある  参照のモード  各 MongoDB ドライバーは以下の５つのモードをサポートしている  primary  Primary からのみ参照する Primary が使用できない場合はエラーになる デフォルト  primaryPreferred  Primary から参照するが使用できない場合は Secondary から参照する  secondary  Secondary からのみ参照する 使用可能な Secondary が無い場合はエラーになる  secondaryPreferred  Secondary から参照するが使用可能な Secondary が１台もない場合は Primary から参照する  nearest  ネットワークレイテンシが最も低いメンバーから参照する Primary, Secondary 問わない  サーバ選択アルゴリズム  サーバーの選択は操作ごとに1回発生し、参照設定とlocalThresholdMS の設定によって決められる サーバ選択アルゴリズムは各クライアントで実装されている secondary または secondaryPreferred モードを指定した場合 * 最も低いレイテンシ + 15msec 以内のサーバを「使用可能」とする  15msec はデフォルト値であり変更可能 「使用可能」なサーバ群からランダムで接続先が決定される    Links  https://docs."><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-42113411-10','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=stylesheet href=https://blog.mknkisk.com/css/main.min.css><script src=https://blog.mknkisk.com/js/jquery.min.js></script><script src=https://blog.mknkisk.com/js/lazysizes.min.js></script><link rel=stylesheet href=https://blog.mknkisk.com/css/fontawsome.min.css><script src=https://blog.mknkisk.com/js/medium-zoom.min.js></script><body class="d-flex flex-column h-100"><header><div class="container-lg clearfix"><div class="col-12 link-primary"><a class=main-title href=https://blog.mknkisk.com/>mknkisk.log</a></div></div></header><main><div class="container-lg clearfix"><div class="col-md-9 col-12 float-left" id=content><article><h4 class=post-title><a href=https://blog.mknkisk.com/posts/mongodb-read-preference-note/>MongoDB : Replica Set の参照設定</a></h4><div class="post-meta link-alter"><time><i class="fas fa-calendar-day"></i>&nbsp;2018-06-04</time><span><i class="fas fa-tag"></i>&nbsp;No tag</span></div><div class="post-content markdown-body"><p>📝MongoDB のドキュメントを箇条書きしていく。随時更新</p><h2 id=env--versions>Env / Versions</h2><ul><li>MongoDB v3.6</li></ul><h2 id=参照の優先度設定>参照の優先度設定</h2><ul><li>⚠️ Primary から Secondary への非同期レプリケーションには遅延が発生するため、古いデータが返される可能性がある</li></ul><h2 id=参照のモード>参照のモード</h2><ul><li>各 MongoDB ドライバーは以下の５つのモードをサポートしている</li></ul><h3 id=primary>primary</h3><ul><li>Primary からのみ参照する</li><li>Primary が使用できない場合はエラーになる</li><li>デフォルト</li></ul><h3 id=primarypreferred>primaryPreferred</h3><ul><li>Primary から参照するが使用できない場合は Secondary から参照する</li></ul><h3 id=secondary>secondary</h3><ul><li>Secondary からのみ参照する</li><li>使用可能な Secondary が無い場合はエラーになる</li></ul><h3 id=secondarypreferred>secondaryPreferred</h3><ul><li>Secondary から参照するが使用可能な Secondary が１台もない場合は Primary から参照する</li></ul><h3 id=nearest>nearest</h3><ul><li>ネットワークレイテンシが最も低いメンバーから参照する</li><li>Primary, Secondary 問わない</li></ul><h2 id=サーバ選択アルゴリズム>サーバ選択アルゴリズム</h2><ul><li>サーバーの選択は操作ごとに1回発生し、参照設定とlocalThresholdMS の設定によって決められる</li><li>サーバ選択アルゴリズムは各クライアントで実装されている</li><li>secondary または secondaryPreferred モードを指定した場合 * 最も低いレイテンシ + 15msec
以内のサーバを「使用可能」とする<ul><li>15msec はデフォルト値であり変更可能</li><li>「使用可能」なサーバ群からランダムで接続先が決定される</li></ul></li></ul><h2 id=links>Links</h2><ul><li><a href=https://docs.mongodb.com/manual/core/read-preference/>https://docs.mongodb.com/manual/core/read-preference/</a></li><li><a href=https://docs.mongodb.com/manual/core/read-preference-mechanics/>https://docs.mongodb.com/manual/core/read-preference-mechanics/</a></li><li><a href=https://www.manning.com/books/mongodb-in-action-second-edition target=_blank>Manning | MongoDB in Action, Second Edition</a></li></ul></div></article><div class="license markdown-body"><blockquote><p>Unless otherwise noted, the content of this site is licensed under <a rel=license href target=_blank></a>.</p></blockquote></div></div><div class="col-md-3 col-12 float-left link-alter" id=sidebar><div class=widget-toc><h5>TOC</h5><nav id=TableOfContents><ul><li><a href=#env--versions>Env / Versions</a></li><li><a href=#参照の優先度設定>参照の優先度設定</a></li><li><a href=#参照のモード>参照のモード</a><ul><li><a href=#primary>primary</a></li><li><a href=#primarypreferred>primaryPreferred</a></li><li><a href=#secondary>secondary</a></li><li><a href=#secondarypreferred>secondaryPreferred</a></li><li><a href=#nearest>nearest</a></li></ul></li><li><a href=#サーバ選択アルゴリズム>サーバ選択アルゴリズム</a></li><li><a href=#links>Links</a></li></ul></nav></div><div class=widget-pages><h5>Pages</h5><ul><li><a href=/index.xml target=_blank>RSS</a></li></ul></div><div class=widget-tags><h5>Tags</h5><div></div></div><div class=widget-links><h5>Links</h5><ul></ul></div></div></div></main><footer><div class="container-lg text-center"><p>&copy; 2020 <a href=https://blog.mknkisk.com/></a>| Powered by <a href=https://github.com/amzrk2/hugo-theme-fuji/ target=_blank>Fuji</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></p></div></footer><script>$(function(){mediumZoom('.img-zoomable',{margin:32});});</script><script>$('.widget-toc a').click(function(){$('html, body').animate({scrollTop:$($(this).attr('href')).offset().top});});</script></body></html>