<!doctype html><html lang=en><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=x-ua-compatible content="IE=edge"><meta http-equiv=cache-control content="no-transform"><meta http-equiv=cache-control content="no-siteapp"><meta name=generator content="Hugo 0.68.3"><link rel="shortcut icon" href=https://cdn.jsdelivr.net/gh/amzrk2/poal-jsdelivr@1.2.0/favicons/favicon.ico><title>Categories - mknkisk.log</title><meta name=author content><meta name=description content><meta property="og:title" content="Categories"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://blog.mknkisk.com/categories/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Categories"><meta name=twitter:description content><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-42113411-10','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><link rel=stylesheet href=https://blog.mknkisk.com/css/main.min.css><script src=https://blog.mknkisk.com/js/jquery.min.js></script><script src=https://blog.mknkisk.com/js/lazysizes.min.js></script><link rel=stylesheet href=https://blog.mknkisk.com/css/fontawsome.min.css><script src=https://blog.mknkisk.com/js/medium-zoom.min.js></script><body class="d-flex flex-column h-100"><header><div class="container-lg clearfix"><div class="col-12 link-primary"><a class=main-title href=https://blog.mknkisk.com/>mknkisk.log</a></div></div></header><main><div class="container-lg clearfix"><div class="col-md-9 col-12 float-left" id=content><div class=post><h2 class=post-title><a href=https://blog.mknkisk.com/posts/mongodb-3-index-explain/>MongoDB 3.x インデックス生成前後のexplain()結果を読む</a></h2><div class="post-meta link-alter"><time><i class="fas fa-calendar-day"></i>&nbsp;2015-05-10</time><span><i class="fas fa-tag"></i>&nbsp;No tag</span></div><div class="post-summary markdown-body">はじめに MongoDB 3.0 から explain() の出力結果が変わり、読み解くのに時間がかかってしまいました。 今回はインデックスの生成前後で explain() の結果がどう変わるかを確認してみます。
環境 Mac OS X 10.10.3 MongoDB 3.0.2 MongoDB storage engine: mmapv1 (default) サンプルデータの準備 DBを用意 $ mongo > use sample_db switched to db sample_db サンプルデータ追加 とりあえず10万件のドキュメントを生成しておきます。
> for (var i=0; i &lt; 100000; i++) { ... db.items.insert({ name: 'item_' + i, price: 100 + i }) ... } > db.items.count() 100000 インデックスが無い状態 itemsコレクションから119円の商品を探すクエリを実行します。
> db.items.find({price: 119}).explain("executionStats") { "queryPlanner" : { "plannerVersion" : 1, "namespace" : "sample_db.</div></div><div class=post><h2 class=post-title><a href=https://blog.mknkisk.com/posts/jq-command/>jqコマンドを使ってみた</a></h2><div class="post-meta link-alter"><time><i class="fas fa-calendar-day"></i>&nbsp;2013-06-28</time><span><i class="fas fa-tag"></i>&nbsp;No tag</span></div><div class="post-summary markdown-body">jqコマンドなるものがあるそうなので入れてみました。
jq - GitHub Pages 参考にさせて頂いたのはこちらの記事です。
jqコマンドが実は高性能すぎてビビッた話 jqはコマンドラインでJSONデータを扱うのに便利なコマンドです。
jq is a lightweight and flexible command-line JSON processor.
インストール MacBook Air Mid 2011 Mac OS X 10.8.4 Homebrew 0.9.4 jq version 1.3 Mac なら homebrew を使うのが簡単そうです。
$ brew search jq jq $ brew install jq $ jq --version jq version 1.3 これで終わりです。簡単ですね。 ソースコードからのビルドやLinux, Windowsに関しては 公式ドキュメント をご覧ください。
サンプルのJSONを用意する JSONファイルを用意します。 jqの動きをざっと知りたいので簡素なJSONを。
$ cat sample.json {"items":[{"name":"kirino"},{"name":"kuroneko"}]} 改行もインデントも無いフラットなJSONです。</div></div><ul class=pagination><li class=pag-first><a href=/categories/><i class="fas fa-angle-double-left"></i></a></li><li class=pag-previous><a href=/categories/page/3/><i class="fas fa-angle-left"></i></a></li><li class=pag-item><a href=/categories/>1</a></li><li class=pag-item><a href=/categories/page/2/>2</a></li><li class=pag-item><a href=/categories/page/3/>3</a></li><li class="pag-item pag-current"><a href=/categories/page/4/>4</a></li></ul></div><div class="col-md-3 col-12 float-left link-alter" id=sidebar><div class=widget-pages><h5>Pages</h5><ul><li><a href=/index.xml target=_blank>RSS</a></li></ul></div><div class=widget-tags><h5>Tags</h5><div></div></div><div class=widget-links><h5>Links</h5><ul></ul></div></div></div></main><footer><div class="container-lg text-center"><p>&copy; 2020 <a href=https://blog.mknkisk.com/></a>| Powered by <a href=https://github.com/amzrk2/hugo-theme-fuji/ target=_blank>Fuji</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></p></div></footer><script>$(function(){mediumZoom('.img-zoomable',{margin:32});});</script></body></html>